---
title: SDK API Reference
description: Comprehensive API reference for the Agentsmith SDK.
---

import { TypeTable } from 'fumadocs-ui/components/type-table';

This page provides a detailed reference for all the classes, methods, and options available in the Agentsmith SDK.

## `AgentsmithClient`

The main client for interacting with the Agentsmith API.

### Constructor

`new AgentsmithClient<T>(apiKey, projectId, options)`

**Parameters:**

- `apiKey: string` (required)
- `projectId: string` (required)
- `options: AgentsmithClientOptions` (optional)

### `AgentsmithClientOptions`

<TypeTable
  type={{
    completionLogDirTransformer: {
      description:
        'Specify a log directory transformer to use parameters from an execution to structure your log directory for easier navigation.',
      type: '(options: object) => string',
    },
    completionLogsDirectory: {
      description:
        'Specify a log directory to save all completions to your local file system for easy debugging.',
      type: 'string | null',
    },
    logLevel: {
      description:
        "Specify a `logLevel` to have the Agentsmith SDK output logs how you want. Can be 'debug', 'info', 'warn', 'error', or 'silent'.",
      type: 'LogLevel',
      default: 'warn',
    },
    logger: {
      description:
        'Specify a `logger` to have the Agentsmith SDK output logs how you want. If not provided, a default console logger is created based on `logLevel`.',
      type: 'Logger',
    },
    fetchStrategy: {
      description:
        "Controls how prompts and globals are fetched. Can be 'remote-fallback', 'fs-fallback', 'remote-only', or 'fs-only'.",
      type: 'FetchStrategy',
      default: 'remote-fallback',
    },
    queueOptions: {
      description:
        'We use p-queue to queue up saving logs in the background. You can limit the concurrency and other options. See [p-queue docs](https://www.npmjs.com/package/p-queue) for details.',
      type: 'PQueueOptions',
    },
    agentsmithDirectory: {
      description:
        'Path to your agentsmith folder. Note: The Studio only writes to the root `agentsmith` folder. Allowing a custom path for the Studio to write to is planned in future updates.',
      type: 'string',
      default: './agentsmith',
    },
    supabaseAnonKey: {
      description:
        'The Supabase anonymous key for your project. Can be overridden for self-hosting purposes.',
      type: 'string',
      default: '',
    },
    supabaseUrl: {
      description:
        'The Supabase URL for your project. Can be overridden for self-hosting purposes.',
      type: 'string',
      default: '',
    },
    agentsmithApiRoot: {
      description:
        'The root URL for the Agentsmith API. Can be overridden for self-hosting purposes.',
      type: 'string',
      default: 'https://agentsmith.dev',
    },
  }}
/>

### Methods

#### `getPrompt(arg)`

Fetches a prompt from Agentsmith.

- `arg: PromptIdentifier<Agency>` (required): The identifier for the prompt, e.g., `'my-prompt'` or `'my-prompt@1.2.3'`.

**Returns:** `Promise<Prompt<Agency, PromptArg>>`

#### `shutdown()`

Gracefully shuts down the client, ensuring all background operations complete. This is crucial for allowing scripts and serverless functions to exit cleanly.

---

## `Prompt`

Represents a single, versioned prompt fetched from Agentsmith. It is not constructed directly, but rather returned from `agentsmithClient.getPrompt`.

### Methods

#### `compile(variables, options)`

Compiles the prompt with the given variables.

##### `CompileOptions`

<TypeTable
  type={{
    globals: {
      description: 'Override global context variables during compilation.',
      type: "Partial<Agency['globals']>",
    },
  }}
/>

##### `CompileResult`

<TypeTable
  type={{
    compiledPrompt: {
      description: 'The compiled prompt content.',
      type: 'string',
    },
    finalVariables: {
      description: 'The final variables used for compilation, including defaults and globals.',
      type: 'any',
    },
  }}
/>

#### `execute(variables, options)`

Executes the prompt with the given variables. The `execute` method returns an object with different fields depending on whether streaming is enabled.

##### `ExecuteOptions`

<TypeTable
  type={{
    globals: {
      description: 'Override global context variables during execution.',
      type: "Partial<Agency['globals']>",
    },
    config: {
      description:
        "Override the prompt's model configuration. See [OpenRouter's API docs](https://openrouter.ai/docs/api-reference/overview).",
      type: 'CompletionConfig',
    },
  }}
/>

##### `ExecuteNonStreamingResult`

<TypeTable
  type={{
    finalVariables: {
      description: 'The final variables used for compilation, including defaults and globals.',
      type: 'any',
    },
    compiledPrompt: {
      description: 'The compiled prompt content sent to the LLM.',
      type: 'string',
    },
    logUuid: {
      description: 'The UUID of the log entry created for this execution.',
      type: 'string',
    },
    response: {
      description: 'The raw HTTP Response object.',
      type: 'Response',
    },
    completion: {
      description: 'The full OpenRouter completion object.',
      type: 'OpenrouterNonStreamingResponse',
    },
    toolCalls: {
      description:
        'The AI response tool calls, equivalent to `completion.choices[0].message.tool_calls`.',
      type: 'ToolCall[] | null',
    },
    reasoning: {
      description:
        'The AI response reasoning, equivalent to `completion.choices[0].message.reasoning`.',
      type: 'string | null',
    },
    content: {
      description:
        'The AI response content, equivalent to `completion.choices[0].message.content`.',
      type: 'string | null',
    },
  }}
/>

##### `ExecuteStreamingResult`

<TypeTable
  type={{
    finalVariables: {
      description: 'The final variables used for compilation, including defaults and globals.',
      type: 'any',
    },
    compiledPrompt: {
      description: 'The compiled prompt content sent to the LLM.',
      type: 'string',
    },
    logUuid: {
      description: 'The UUID of the log entry created for this execution.',
      type: 'string',
    },
    response: {
      description: 'The raw HTTP Response object.',
      type: 'Response',
    },
    completion: {
      description:
        'A promise that resolves with the full completion object once the stream is finished.',
      type: 'Promise<OpenrouterNonStreamingResponse>',
    },
    stream: {
      description: 'The raw SSE stream as an AsyncIterable of parsed events for more control.',
      type: 'ReadableStream<Uint8Array>',
    },
    toolCalls: {
      description: 'An async generator that yields tool calls as they arrive.',
      type: 'AsyncGenerator<ToolCall, void, unknown>',
    },
    reasoningTokens: {
      description: 'An async generator that yields reasoning tokens as strings.',
      type: 'AsyncGenerator<string | undefined, void, unknown>',
    },
    tokens: {
      description: 'An async generator that yields content tokens as strings.',
      type: 'AsyncGenerator<string | undefined, void, unknown>',
    },
  }}
/>

##### `CompletionLogDirTransformerOptions`

<TypeTable
  type={{
    rawOutput: {
      description: 'The raw output returned from the LLM or completion endpoint.',
      type: 'any',
    },
    rawInput: {
      description: 'The raw input sent to the LLM or completion endpoint.',
      type: 'any',
    },
    variables: {
      description: 'The variables used for the prompt execution.',
      type: 'Record<string, any>',
    },
    promptVersion: {
      description:
        'Information about the prompt version, including uuid, version, config, and content.',
      type: '{ uuid: string; version: string; config: any; content: string; }',
    },
    prompt: {
      description: 'Metadata about the prompt, including name, slug, and uuid.',
      type: '{ name: string; slug: string; uuid: string; }',
    },
    logUuid: {
      description: 'The UUID of the log entry for this completion.',
      type: 'string',
    },
  }}
/>
